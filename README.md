# railgunRelayDrained

## Incident Regarding ~ $730 of Ethereum drained from my railgun relay. 

#### Synopsis
Starting at Apr-07-2025 at 10:12:47 AM UTC, my railgun relay suffered a series of attacks. Twelve transactions over the course of an hour reverted, costing me about $730, or about .48 Ethereum. The attacks contiunued until all of my relay's available ethereum was depleted. Upon further analysis, I discovered that the target contract for these transactions was this contract: [https://etherscan.io/address/0x87c7f7d6c8e4a358eb798e92574ae129f001d7f5/advanced#internaltx](0x87c7f7d6c8e4a358eb798e92574ae129f001d7f5)


#### Reverting contract: 
<p>
I decompiled the bytecode as the source is not available:
</p>
<pre>
  function _SafeAdd(uint256 varg0, uint256 varg1) private { 
    require(varg0 <= varg0 + varg1, Panic(17)); // arithmetic overflow or underflow
    return varg0 + varg1;
}

function _SafeMul(uint256 varg0, uint256 varg1) private { 
    require(!varg0 | (varg1 == varg0 * varg1 / varg0), Panic(17)); // arithmetic overflow or underflow
    return varg0 * varg1;
}

function fallback() public payable { 
    revert();
}

function 0x67658be1(uint256 varg0, uint256 varg1) public payable { 
    require(4 + (msg.data.length - 4) - 4 >= 64);
    v0 = v1 = 0;
    while (v0 >= varg0) {
        v2 = _SafeAdd(v0, v0);
        v3 = _SafeMul(v2, 2);
        require(2, Panic(18)); // division by zero
        v0 = v3 >> 1;
        v0 += 1;
    }
    require(varg1 >= block.number);
}

// Note: The function selector is not present in the original solidity code.
// However, we display it for the sake of completeness.

function __function_selector__( function_selector) public payable { 
    MEM[64] = 128;
    require(!msg.value);
    if (msg.data.length >= 4) {
        if (0x67658be1 == function_selector >> 224) {
            0x67658be1();
        }
    }
    fallback();
}
</pre>



<p>
Obviously this contract is designed to burn gas and then revert. I am surprised that railgun processed this transaction, as I was under the impression that railgun would 
not proccess a tranasction that would revert. It goes without saying why that must be the case for us relayers. I am not operating a relay until this is fixed or I can 
  figure out how to prevent it from happening again, that's for sure. 
</p>

#### Contract call trace 

<pre>
 [8015295][REVERTED] 0x4025ee6512DBbda97049Bcf5AA5D38C54aF6bE8a


.relay(transactions = [{proof: {a: {x: 14685652643218997115957454293607366312909127389528519760642432106384543825060, y: 4456962887911194449007585034933885260908836022380176718968843710097674984029}, b: {x: [12631071928723512431926100069662170845076824796746316370118977723768134086902, 12829078151501648553967867477340921484991265134534469449283423697323793369359], y: [14298135645597092158706534765897729913805532971455908556017192329292288357943, 14340126838312927707830524245389564877157760216671198894337771848440328100504]}, c: {x: 4275214500205123268319646392667398027958879704426548042206962422311230806187, y: 17270175453701301953999718306280737398365273158754498466872844365440729598454}}, merkleRoot: 0x021e14f0e2835964ffb27a890c95938b8d3fbecb239f603088e1c93f7d4af8c8, nullifiers: [0x19d147da50bf028a3f8df0b8947412745dd47be0c1e8775626c591d4a3c3733c], commitments: [0x0430afb6d27c2e1123fcc71ae2d898b19d9ab6bfc99462cbc2729cd0706bd251, 0x123257bb84f1874f20b57c57b16db0aabf1f142f8f06c93af87d761b1f1500aa, 0x1fa67112b1394c55edaf535be41643bf25a608b9c95ebf884b004a141510d27e], boundParams: {treeNumber: 1, minGasPrice: 4487114934, decrypt: 1, chainID: 1, adaptContract: 0x4025ee6512DBbda97049Bcf5AA5D38C54aF6bE8a


, adaptParams: 0xa31bbd554ab0ad52e84779404b1cef1665331bd008183f962aeafaed35390a33, commitmentCiphertext: [{ciphertext: [0x487ee97f0fa05260cfa1e6e16eafad24572c8f0d087b2061a822a5f91db78aa5, 0xce457a007fcfe9997999efd7a1a36a60912993454069f368fb9759fde0816fef, 0xf5192d4fa0ccf84bbbd9251f45ae41daff2ec84ba3784ebd011c92c81df0a03c, 0x93096a2e88b685cd82abec6a8d863c8b184a776fa8f3fb7e7b18e8c7cfe6988e], blindedSenderViewingKey: 0xf66523d1420b2f765d2b67359fe442a8d6ec48d690e0e0c243a9639c0beb8b85, blindedReceiverViewingKey: 0x8bd1e5e80038833b37fa292cc63d5305cdfceeb06a84f43a3de7d1cfdfe7e3e2, annotationData: 0x51be4b5a48afa1470284d107280eeb8bce5a0cde42e77c22c0d9a61435c85669639b30d9f557a82b93477497fe29751317955bb8417fe85e0216ac0025a9, memo: 0x}, {ciphertext: [0x30ac5c7097bdd376e3aa5a4e8958824fab16dcb88b0870151349e6d368ef438c, 0xa470b9e3712859112204e9c52b7190b1ede72dc5aa31868e0614c00cbd6f2cbb, 0x5e410b591c39c3ad2eb372473ee8d31c790fa5bd97353aa9336fefd80d385cfa, 0x9601fbb7b129d6e74ce11072b322df48466c5fd983a94af7934202d05ec0ea6a], blindedSenderViewingKey: 0xf52cef64aa5ce80d1f81abdd0dd54502deba4ef1e47472c7c4dd3ad6ad1d011d, blindedReceiverViewingKey: 0xf52cef64aa5ce80d1f81abdd0dd54502deba4ef1e47472c7c4dd3ad6ad1d011d, annotationData: 0xbe8ea95f244105e1e08e774b07997698834aeb2aa8ae0a819ca545df78b73525d7f272820ec6d0fe35b69af09b7016a34c5f45558dc70a6cb37faad3f903, memo: 0x}]}, decryptPreimage: {npk: 0x0000000000000000000000004025ee6512dbbda97049bcf5aa5d38c54af6be8a, token: {tokenType: 0, tokenAddress: Wrapped Ether




, tokenSubID: 0}, value: 1000000000000000}}], actionData = {random: 0x527dfe356b8dc27edec2138b99ff817c540276be8d046b3de95750eb0883e7, requireSuccess: True, minGasLimit: 2550000, calls: [{to: 0x87C7F7d6C8E4a358EB798e92574ae129f001D7f5


, data: 0x67658be10000000000000000000000000000000000000000000000000000000000002710000000000000000000000000000000000000000000000000000000000153021c, value: 0}, {to: 0x4025ee6512DBbda97049Bcf5AA5D38C54aF6bE8a


, data: 0x044a40c300000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002091fdc2977266568c1c2e736329967f8dc38e04e193e2ade4f583d7d68b85b210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000029beabe067faf9a3955216b01bae145cff69c31231793a2f5428d2586da11609deca4877f4fd758166f8509ff3068d496ade745c064e41190ce25318dc9266658a27bf21f7a542213e90d58095f894b5590613a0b05460a32b5004fd10ed75de8d2d503c7ee6f5d052b180782a9f24d06b97d19995c0dc245dd2256164d77a6091fdc2977266568c1c2e736329967f8dc38e04e193e2ade4f583d7d68b85b210000000000000000000000000000000000000000000000000000000000000000000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000dd4424ee611afcb0ab5efb6e0ea79ff746aeb25cb2febb37553124b1d3f98cf389ae453e30969464ac61e7d6a4e065169e0490f7a7f26d7a78e090cca72b7a35907a8d96e5f8fc1ba949dea84421f5f67dc34e25afd1cba2af05132b7da081072539b4e79799863c039b3ea6a2c0b6ff0bf3ec579cb096045c7490342d9b3a4a, value: 0}]})
CALL

[1082292]PausableUpgradableProxy




.#d8ae136a(0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000202077c8eb1c61e7bfebdeea6571631f40790ef4582a9145610de06a877eb1bca409da8d35927f7bd49eb2abc8f8bf41a5c95780b241e43100565305750033da5d1beceef0e0c24d94e88f9600dcedc7ea7be435b1b05e3751a64049fef76eb0f61c5d003bdf3b155ec8ad14589aeb4beb73c59f36879fe15aecf4c8698428c90f1f9c753eccd48852ab1c8dce7406fa01e4c249a69824136a75b1c556afe3f6371fb43962b3fd19ef11aa8c8c64ba72d1c22fc90fe080b15e40bb77a495961a980973af87325a34b97c569de474bb9af09ba4ec054b12ce37f1bb5ff21d8a98ab262e92aa29c757a9a961a2824e52b0a8a00c2213c57b2c7bedae5eba792dc9f6021e14f0e2835964ffb27a890c95938b8d3fbecb239f603088e1c93f7d4af8c80000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000002e00000000000000000000000004025ee6512dbbda97049bcf5aa5d38c54af6be8a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000038d7ea4c68000000000000000000000000000000000000000000000000000000000000000000119d147da50bf028a3f8df0b8947412745dd47be0c1e8775626c591d4a3c3733c00000000000000000000000000000000000000000000000000000000000000030430afb6d27c2e1123fcc71ae2d898b19d9ab6bfc99462cbc2729cd0706bd251123257bb84f1874f20b57c57b16db0aabf1f142f8f06c93af87d761b1f1500aa1fa67112b1394c55edaf535be41643bf25a608b9c95ebf884b004a141510d27e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000010b73f0b6000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000004025ee6512dbbda97049bcf5aa5d38c54af6be8aa31bbd554ab0ad52e84779404b1cef1665331bd008183f962aeafaed35390a3300000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001c0487ee97f0fa05260cfa1e6e16eafad24572c8f0d087b2061a822a5f91db78aa5ce457a007fcfe9997999efd7a1a36a60912993454069f368fb9759fde0816feff5192d4fa0ccf84bbbd9251f45ae41daff2ec84ba3784ebd011c92c81df0a03c93096a2e88b685cd82abec6a8d863c8b184a776fa8f3fb7e7b18e8c7cfe6988ef66523d1420b2f765d2b67359fe442a8d6ec48d690e0e0c243a9639c0beb8b858bd1e5e80038833b37fa292cc63d5305cdfceeb06a84f43a3de7d1cfdfe7e3e200000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000003e51be4b5a48afa1470284d107280eeb8bce5a0cde42e77c22c0d9a61435c85669639b30d9f557a82b93477497fe29751317955bb8417fe85e0216ac0025a90000000000000000000000000000000000000000000000000000000000000000000030ac5c7097bdd376e3aa5a4e8958824fab16dcb88b0870151349e6d368ef438ca470b9e3712859112204e9c52b7190b1ede72dc5aa31868e0614c00cbd6f2cbb5e410b591c39c3ad2eb372473ee8d31c790fa5bd97353aa9336fefd80d385cfa9601fbb7b129d6e74ce11072b322df48466c5fd983a94af7934202d05ec0ea6af52cef64aa5ce80d1f81abdd0dd54502deba4ef1e47472c7c4dd3ad6ad1d011df52cef64aa5ce80d1f81abdd0dd54502deba4ef1e47472c7c4dd3ad6ad1d011d00000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000003ebe8ea95f244105e1e08e774b07997698834aeb2aa8ae0a819ca545df78b73525d7f272820ec6d0fe35b69af09b7016a34c5f45558dc70a6cb37faad3f90300000000000000000000000000000000000000000000000000000000000000000000)
D-CALL

[1074567][delegator: PausableUpgradableProxy




]RailgunSmartWallet




.transact(_transactions = [{proof: {a: {x: 14685652643218997115957454293607366312909127389528519760642432106384543825060, y: 4456962887911194449007585034933885260908836022380176718968843710097674984029}, b: {x: [12631071928723512431926100069662170845076824796746316370118977723768134086902, 12829078151501648553967867477340921484991265134534469449283423697323793369359], y: [14298135645597092158706534765897729913805532971455908556017192329292288357943, 14340126838312927707830524245389564877157760216671198894337771848440328100504]}, c: {x: 4275214500205123268319646392667398027958879704426548042206962422311230806187, y: 17270175453701301953999718306280737398365273158754498466872844365440729598454}}, merkleRoot: 0x021e14f0e2835964ffb27a890c95938b8d3fbecb239f603088e1c93f7d4af8c8, nullifiers: [0x19d147da50bf028a3f8df0b8947412745dd47be0c1e8775626c591d4a3c3733c], commitments: [0x0430afb6d27c2e1123fcc71ae2d898b19d9ab6bfc99462cbc2729cd0706bd251, 0x123257bb84f1874f20b57c57b16db0aabf1f142f8f06c93af87d761b1f1500aa, 0x1fa67112b1394c55edaf535be41643bf25a608b9c95ebf884b004a141510d27e], boundParams: {treeNumber: 1, minGasPrice: 4487114934, unshield: 1, chainID: 1, adaptContract: 0x4025ee6512DBbda97049Bcf5AA5D38C54aF6bE8a


, adaptParams: 0xa31bbd554ab0ad52e84779404b1cef1665331bd008183f962aeafaed35390a33, commitmentCiphertext: [{ciphertext: [0x487ee97f0fa05260cfa1e6e16eafad24572c8f0d087b2061a822a5f91db78aa5, 0xce457a007fcfe9997999efd7a1a36a60912993454069f368fb9759fde0816fef, 0xf5192d4fa0ccf84bbbd9251f45ae41daff2ec84ba3784ebd011c92c81df0a03c, 0x93096a2e88b685cd82abec6a8d863c8b184a776fa8f3fb7e7b18e8c7cfe6988e], blindedSenderViewingKey: 0xf66523d1420b2f765d2b67359fe442a8d6ec48d690e0e0c243a9639c0beb8b85, blindedReceiverViewingKey: 0x8bd1e5e80038833b37fa292cc63d5305cdfceeb06a84f43a3de7d1cfdfe7e3e2, annotationData: 0x51be4b5a48afa1470284d107280eeb8bce5a0cde42e77c22c0d9a61435c85669639b30d9f557a82b93477497fe29751317955bb8417fe85e0216ac0025a9, memo: 0x}, {ciphertext: [0x30ac5c7097bdd376e3aa5a4e8958824fab16dcb88b0870151349e6d368ef438c, 0xa470b9e3712859112204e9c52b7190b1ede72dc5aa31868e0614c00cbd6f2cbb, 0x5e410b591c39c3ad2eb372473ee8d31c790fa5bd97353aa9336fefd80d385cfa, 0x9601fbb7b129d6e74ce11072b322df48466c5fd983a94af7934202d05ec0ea6a], blindedSenderViewingKey: 0xf52cef64aa5ce80d1f81abdd0dd54502deba4ef1e47472c7c4dd3ad6ad1d011d, blindedReceiverViewingKey: 0xf52cef64aa5ce80d1f81abdd0dd54502deba4ef1e47472c7c4dd3ad6ad1d011d, annotationData: 0xbe8ea95f244105e1e08e774b07997698834aeb2aa8ae0a819ca545df78b73525d7f272820ec6d0fe35b69af09b7016a34c5f45558dc70a6cb37faad3f903, memo: 0x}]}, unshieldPreimage: {npk: 0x0000000000000000000000004025ee6512dbbda97049bcf5aa5d38c54af6be8a, token: {tokenType: 0, tokenAddress: Wrapped Ether




, tokenSubID: 0}, value: 1000000000000000}}])
D-CALL

[45128][delegator: PausableUpgradableProxy




]0x7022Be532D911cc3A7180288b504cdc3f498c3BF


.#5a53025d(0000000000000000000000004025ee6512dbbda97049bcf5aa5d38c54af6be8a000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000038d7ea4c68000)

S-CALL

[6000]precompile




.ecmul(x1 = 0x1ad7236830f73762531e861b32db2bd2fa8eb8d15115d158b344fdd0ab4e33fe, y1 = 0x089334abe4abbbc5888aa054dfe51fa7368a4c4253c5ed023e5cf56f2154749c, s = 0x021e14f0e2835964ffb27a890c95938b8d3fbecb239f603088e1c93f7d4af8c8)

S-CALL

[150]precompile




.ecadd(x1 = 0x0000000000000000000000000000000000000000000000000000000000000000, y1 = 0x0000000000000000000000000000000000000000000000000000000000000000, x2 = 0x1b61f9aeb4594526443ddc6a24b955a514984c9d7f7a1ce3abfef6bdf2c3ceaf, y2 = 0x285bb8fed876eef9076a646742e8c60f44a08800fa14bf041c79befc4a4e23aa)

S-CALL

[6000]precompile




.ecmul(x1 = 0x2eb6e7c36f8ca7228a0444bcf614860a85e09f1d6ae6d6adc0410a2f144053e6, y1 = 0x0a34135499b958031a9b3704b03be173dd90d8a90afc0651b0f1a27cc0d366e8, s = 0x220889f0b0b11d6ac80839d5f5acd11b2eea6c8b791a5a71f1f2d011110bcb07)

S-CALL

[150]precompile




.ecadd(x1 = 0x1b61f9aeb4594526443ddc6a24b955a514984c9d7f7a1ce3abfef6bdf2c3ceaf, y1 = 0x285bb8fed876eef9076a646742e8c60f44a08800fa14bf041c79befc4a4e23aa, x2 = 0x25423bf82bb2ff95cde9cef70f57c89000d85e671f2b938d17a0dc52b344be8c, y2 = 0x252eed57577840dd308d208a0a3635aacff6c77837790861ec78493a9f9114ad)

S-CALL

[6000]precompile




.ecmul(x1 = 0x0182dc9d186f4f8689b217998df70e7d2281934802e57293713bcb7af4da9a12, y1 = 0x22c9c00f7153c7b8dcad698e63730101ed2abb77ee584e44eced54966c56585c, s = 0x19d147da50bf028a3f8df0b8947412745dd47be0c1e8775626c591d4a3c3733c)

S-CALL

[150]precompile




.ecadd(x1 = 0x2e3a49e9c89c95d5c2a2513c1289cae798440afd9d6ab4900ca7f4c1575c1d3b, y1 = 0x22e3854a8471dc4d955a5d51e9f67eef98a9b48d4c8ec49262202ae8d327c7af, x2 = 0x10c7fc1d1143d401fad7631bf38ec09f07fd0b247e4224d28bb77ace7f107c0e, y2 = 0x15cb1492e7602b07e551cdeff6a5d8791327765b10196085e38b9d289b014f3f)

S-CALL

[6000]precompile




.ecmul(x1 = 0x122c09dbbddf846b60b52c31669d92ae79ddfdee7f4305e08a9bf6c5dfde1629, y1 = 0x0d247317267d3c99380614513a4c1ac9ab3ffbdbf564e9a73d37597c2eeecc21, s = 0x0430afb6d27c2e1123fcc71ae2d898b19d9ab6bfc99462cbc2729cd0706bd251)

S-CALL

[150]precompile




.ecadd(x1 = 0x233152305876b6d96dd67686172327e62ee5bcba56b71f294c8fd03f8ed3f65e, y1 = 0x003eb4186dc5847b4fa8e68e3f0d89c6fb6100eba90d69fc34990a224e40b745, x2 = 0x0f353317c911e020a608ca5ce09f12d055576f8b7e6623ef3b080a3f71d34425, y2 = 0x10a23b8292a7c8ad3cec6aef6e9d3ff380dae365c73fec568d5e5d92f29de8a8)

S-CALL

[6000]precompile




.ecmul(x1 = 0x2a02da6192cf98e384d11e4a8bb344db93df1616f7e43bb7220133a39f17b796, y1 = 0x303e4bca755408deba18ade747718a445d0ce45d141e9e169d774869c0394ace, s = 0x123257bb84f1874f20b57c57b16db0aabf1f142f8f06c93af87d761b1f1500aa)

S-CALL

[150]precompile




.ecadd(x1 = 0x237b1624e640953c6fa52c7fb771be4a57c3f21d8bfff58c446bf31605470d20, y1 = 0x0f9dcb9bc9b060bb7c23831795f4d58234de67721840d4dd1bad730b5b987377, x2 = 0x27cc4a6374f87f4e96fd6ee09d565942401a19800fdab618b2aa27715dbedf6f, y2 = 0x1bc39b55d05bfa399652f54b982eaa0d79c70b2f290f6ecc71082506ebf775b9)

S-CALL

[6000]precompile




.ecmul(x1 = 0x14b6f4ec88ba1c57ab7e17bfe440e690e4d3165396b5db295046087de83b4082, y1 = 0x015e143455587b909c5ca231c96568a8b5eda87de54e4c84bca9a3d83d4ff1a9, s = 0x1fa67112b1394c55edaf535be41643bf25a608b9c95ebf884b004a141510d27e)

S-CALL

[150]precompile




.ecadd(x1 = 0x1cbac950ec9c8a7de227e8d16272fd8093eb0077a2711f31fb7476aa6288bcf5, y1 = 0x0d0c4edba1a608dbe8d358c9ec2ab73c451ae84d7c5c31a79c9a6943464e42ce, x2 = 0x286d3d412726d68bab4ac11460274b9fed1e3886c152d908644055134a8b764b, y2 = 0x168f7825eec75adf5c59d8047cfe301846b47d822b47c3c88308e11c4150df16)

S-CALL

[150]precompile




.ecadd(x1 = 0x03c33f061afe352281b9caf44e1b774882ae7e4617717a92efae0c8f7d92eb54, y1 = 0x2e9c1e4574741d6f1154555dcef1d16741447afd8a7127996d037503ee385718, x2 = 0x045db5892ed478463742704d72de19eb9ad140abf2b0e0ec524cb3027ba5a527, y2 = 0x0981f417de686ec816ce244efcadb352acea8582c47a92c0383aed3970c34d6f)

S-CALL

[181000]precompile




.ecpairing(x1 = 0x2077c8eb1c61e7bfebdeea6571631f40790ef4582a9145610de06a877eb1bca4, y1 = 0x2689c13d4eb22455199d99ed88c216b7ce29e9df268d998ce5cd86a1d84922ea, x2 = 0x1beceef0e0c24d94e88f9600dcedc7ea7be435b1b05e3751a64049fef76eb0f6, y2 = 0x1c5d003bdf3b155ec8ad14589aeb4beb73c59f36879fe15aecf4c8698428c90f, x3 = 0x1f9c753eccd48852ab1c8dce7406fa01e4c249a69824136a75b1c556afe3f637, y3 = 0x1fb43962b3fd19ef11aa8c8c64ba72d1c22fc90fe080b15e40bb77a495961a98)

LOG1

emit Nullified(treeNumber = 1, nullifier = (0x19d147da50bf028a3f8df0b8947412745dd47be0c1e8775626c591d4a3c3733c))

CALL

[29962]Wrapped Ether




.transfer(dst = 0x4025ee6512DBbda97049Bcf5AA5D38C54aF6bE8a


, wad = 997500000000000)

CALL

[8062]Wrapped Ether




.transfer(dst = PausableUpgradableProxy




, wad = 2500000000000)

LOG1

emit Unshield(to = 0x4025ee6512DBbda97049Bcf5AA5D38C54aF6bE8a


, token = (0, Wrapped Ether




, 0), amount = 997500000000000, fee = 2500000000000)

LOG1

emit Transact(treeNumber = 1, startPosition = 20710, hash = (0x0430afb6d27c2e1123fcc71ae2d898b19d9ab6bfc99462cbc2729cd0706bd251, 0x123257bb84f1874f20b57c57b16db0aabf1f142f8f06c93af87d761b1f1500aa), ciphertext = (((0x487ee97f0fa05260cfa1e6e16eafad24572c8f0d087b2061a822a5f91db78aa5, 0xce457a007fcfe9997999efd7a1a36a60912993454069f368fb9759fde0816fef, 0xf5192d4fa0ccf84bbbd9251f45ae41daff2ec84ba3784ebd011c92c81df0a03c, 0x93096a2e88b685cd82abec6a8d863c8b184a776fa8f3fb7e7b18e8c7cfe6988e), 0xf66523d1420b2f765d2b67359fe442a8d6ec48d690e0e0c243a9639c0beb8b85, 0x8bd1e5e80038833b37fa292cc63d5305cdfceeb06a84f43a3de7d1cfdfe7e3e2, 0x51be4b5a48afa1470284d107280eeb8bce5a0cde42e77c22c0d9a61435c85669639b30d9f557a82b93477497fe29751317955bb8417fe85e0216ac0025a9, 0x), ((0x30ac5c7097bdd376e3aa5a4e8958824fab16dcb88b0870151349e6d368ef438c, 0xa470b9e3712859112204e9c52b7190b1ede72dc5aa31868e0614c00cbd6f2cbb, 0x5e410b591c39c3ad2eb372473ee8d31c790fa5bd97353aa9336fefd80d385cfa, 0x9601fbb7b129d6e74ce11072b322df48466c5fd983a94af7934202d05ec0ea6a), 0xf52cef64aa5ce80d1f81abdd0dd54502deba4ef1e47472c7c4dd3ad6ad1d011d, 0xf52cef64aa5ce80d1f81abdd0dd54502deba4ef1e47472c7c4dd3ad6ad1d011d, 0xbe8ea95f244105e1e08e774b07997698834aeb2aa8ae0a819ca545df78b73525d7f272820ec6d0fe35b69af09b7016a34c5f45558dc70a6cb37faad3f903, 0x)))

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(0430afb6d27c2e1123fcc71ae2d898b19d9ab6bfc99462cbc2729cd0706bd251123257bb84f1874f20b57c57b16db0aabf1f142f8f06c93af87d761b1f1500aa)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(1eb16646e5aef60401a7fa744cd9af98cbb79642df84402936e794a54820ad800d1a222ca4625f7cd905174247d7e08b19c4c9e5adc34894f5a4f717ef0f54f5)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(01beeda3f30819aa5ac1c663d3db7c7accbab266c6b1b5a23cb3cfdd64ef5a3d26ad9772df3cd66e5c5c2d8b83224cd84bc233f682df31469a3d1ed11362f4db)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(126856400ad9612de6c7a956cf33972f469b1e5e0fe1fe9b1c4822e5d56bbccb183f531ead7217ebc316b4c02a2aad5ad87a1d56d4fb9ed81bf84f644549eaf5)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(0029d37478879d074d07276b1d41417891f40b3f7729daff062b740ca7cd47fc093c48f1ecedf2baec231f0af848a57a76c6cf05b290a396707972e1defd17df)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(04e3549fd4ecf75623ff1088faffda4425762c0545172ae6d574397cd772d99409661f1529a4b3b6dee8a3c76c8298fd889c31b377ced37b5cacef65f6d3c26e)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(15be442d265014052d8747837554bd600a4d091b5f27937899c43ce78ad43a962d05a7401956402d3cb041e01b61492847dd326e163a5b712372773ffda262d5)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(162cbb62fc67a901847b829e749e56d36db813f8caab2cec9861a8715f14adb0294cf49dd4907fd6ccf95ebcdf9df61d242dd7528d6c034f89e2d71912b93ed1)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(022d252757867701ed92a5739d345bc8ca7e2576831fc4a905124b8fe1d4e8932500bdfc1592791583acefd050bc439a87f1d8e8697eb773e8e69b44973e6fdc)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(1438de637271e7247ea405c736de362e33c1379afaa3dd5d382ca077f20c0eaf244ae3b19397e842778b254cd15c037ed49190141b288ff10eb1390b34dc2c31)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(22e0c6642a9be8e2590646d0918febd89e675a535293acc6ebf5e0ae2a2eeba60ca2b107491c8ca6e5f7e22403ea8529c1e349a1057b8713e09ca9f5b9294d46)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(1b9e0416eab8b4170a569f17c8f7fe1075597224bafa1010cd193f6c7786a09718593c75a9e42af27b5e5b56b99c4c6a5d7e7d6e362f00c8e3f69aeebce52313)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(0f4fd8a1aceab5d060e5bec4ceb4a19cf5d7bf79bd907536ec4bb37b9918b97119bd8c72aedfebb3145a04130521a94a869bb7a07fbb740d5c6b7676719f60a4)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(1007adcd39785adbe21f17b7bfb34c65b86f7d328071ebbb312ce077eb4dc2c72726c22ad3d9e23414887e8233ee83cc51603f58c48a9c9e33cb1f306d4365c0)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(2108d81c39360acee3cc8a13ea7e0337216d3baa7743d55d593a8e36413589da245ed71d8ad84d31e0a0503b1ebdc17b59ef994205c487a7732ea56f47512753)

D-CALL

[29005][delegator: PausableUpgradableProxy




]0x8e5689BDe31b2A8d934138Dfd7e7aA4DB5A68ded


.#299e5660(2454dabf00d586b3723ae2ad6c1f401a25fe311e872127f3c348f4789d9db81427f7c465045e0a4d8bec7c13e41d793734c50006ca08920732ce8c3096261435)



CALL

[6910600][REVERTED] 0x87C7F7d6C8E4a358EB798e92574ae129f001D7f5


.#67658be1(0000000000000000000000000000000000000000000000000000000000002710000000000000000000000000000000000000000000000000000000000153021c)

REVERT

error 
#0x5c0dee5d(000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000) 
</pre>

#### Prevelance of this problem

<p>
  Take a look at the contract's internal message calls and you'll see I am, at least to my knowledge, the third victim that the operator of this contract has hit. This 
  is a serious problem that must be patched immediately. It is extreemely risky to run a relay under these circumstances. Contract calls that burn a bunch of gas and 
  revert will sabotage relayers. My client just lost almost half an ETH. I am annoyed. Not going to lie. Had I known that all of my client's money could be ciphoned, I 
  would not have recommended running this relay. And I don't know how often this has happened, but I imagine more than just 3 times with other contracts. I will analyze the blockchain and find out and update this repo.
</p>

#### Interesting twist
<p>
I think the deployer of this contract is in fact a relay operator. I haven't verified that for sure, but it sure looks that way.
[https://etherscan.io/address/0xfacfc25c10ff9e44cf2439dbbec9b20e887d4530](take a look ... )
</p>

<p>
 I am assuming the culprit is trying to take out the competition. If this type of attack is not fixed, the railgun project will fail. If it's not fixable, there 
  needs to be some kind of insurance fund to reimburse rekt operators. But I think it should be fixable. I thought transactions that would fail were rejected. How is that not the case?
</p>
